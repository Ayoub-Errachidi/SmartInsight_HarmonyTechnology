{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataSet - SmartInsight</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{% static 'css/machine_learning/styles_cible.css' %}">
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <a href="#" class="logo">
            <i class='bx bx-stats'></i>
            <div class="logo-name"><span>Smart</span>Insight</div>
        </a>
        <ul class="side-menu">
            <li><a href="{% url 'dashboard' %}"><i class='bx bxs-dashboard'></i>Import a file</a></li>
            <li><a href="{% url 'informations_dataset' %}"><i class='bx bxs-color'></i>Dashboard</a></li>
            <li class="active"><a href="{% url 'dataset' %}"><i class='bx bx-data'></i>DataSet</a></li>
            <li><a href="{% url 'statistiques' %}"><i class='bx  bx-bar-chart'></i>Statistics</a></li>
            <li><a href="{% url 'visualisations' %}"><i class='bx bx-scatter-chart' ></i>Visualization</a></li>
            <li><a href="{% url 'pretraitement_complet' %}"><i class='bx bx-message-square-dots'></i>Full cleaning</a></li>
            <li><a href="{% url 'choix_cible' %}"><i class='bx bx-crosshair'></i>Target selection</a></li>
            <li><a href="{% url 'transformation_colonnes' %}"><i class='bx bx-analyse'></i>Data Preprocessing </a></li>
            <li><a href="{% url 'resultats_entrainement' %}"><i class="bx bx-bot"></i>Model Training</a></li>
            <li><a href="{% url 'prediction' %}"><i class='bx bx-check-shield'></i>Prediction</a></li>
            <li><a href="{% url 'rapport_pdf' %}"><i class='bx bx-cloud-upload' ></i>Download PDF</a></li>
        </ul>
    </div>
    <!-- End of Sidebar -->

    <!-- Main Content -->
    <div class="content">
        <!-- Navbar -->
        <nav>
            <i class='bx bx-menu'></i>
            <form action="#">
                <div class="form-input">
                    <input type="search" placeholder="Search...">
                    <button class="search-btn" type="submit"><i class='bx bx-search'></i></button>
                </div>
            </form>
            <input type="checkbox" id="theme-toggle" hidden>
            <label for="theme-toggle" class="theme-toggle"></label>
            <a href="#" class="notif">
                <i class='bx bx-bell'></i>
                <span class="count">12</span>
            </a>
            <a href="#" class="profile">
                <img src="{% static 'images/111.png' %}">
            </a>
        </nav>
        <!-- End of Navbar -->


        <!-- Contenu principal -->
        <main class="container">
          <div class="card shadow-sm mx-auto" style="max-width: 700px;">
            <div class="card-header text-center">
              <h2 class="mb-0">Choisir la colonne cible (Target) ou aucune (Clustering)</h2>
            </div>
            <div class="card-body">

              {% if error %}
              <div class="alert alert-danger" role="alert">{{ error }}</div>
              {% endif %}
              {% if success %}
              <div class="alert alert-success" role="alert">{{ success }}</div>
              {% endif %}

              <form method="post" novalidate>
                {% csrf_token %}
                <div class="mb-3">
                  <label for="selected_target" class="form-label fw-bold">Sélectionnez la colonne cible :</label>
                  <select name="selected_target" id="selected_target" class="form-select">
                    <option value="" {% if not previous_target %}selected{% endif %}>-- Aucune cible (clustering) --</option>
                    {% for col in colonnes %}
                    <option value="{{ col }}" {% if col == previous_target %}selected{% endif %}>{{ col }}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="d-grid">
                  <button type="submit" class="btn btn-primary btn-lg">Valider</button>
                </div>
              </form>

              {% if success %}
              <br>
              

              <!-- Type ML détecté -->
              {% if ml_type %}
              <h3>Type d'analyse détecté :
                {% if ml_type == "classification" %}
                <span class="badge badge-classification">Classification</span>
                {% elif ml_type == "regression" %}
                <span class="badge badge-regression">Régression</span>
                {% elif ml_type == "clustering" %}
                <span class="badge badge-clustering">Clustering</span>
                {% endif %}
              </h3>
              {% endif %}

              <h3>Features (X)</h3>
              {% if features_preview %}
              <ul class="list-group mb-4">
                {% for col in features_preview %}
                <li class="list-group-item">{{ col }}</li>
                {% endfor %}
              </ul>
              {% else %}
              <p><em>Aucune feature détectée.</em></p>
              {% endif %}

              <h3>Target (y)</h3>
              {% if target_preview and selected_target %}
              <ul class="list-group">
                {% for col in target_preview %}
                <li class="list-group-item">{{ col }}</li>
                {% endfor %}
              </ul>
              {% else %}
              <p><em>Aucune cible sélectionnée (toutes les colonnes sont utilisées comme features).</em></p>
              {% endif %}
              {% endif %}
            </div>
          </div>

        </main>
  

    </div>

    <script src="{% static 'js/dashboard.js' %}"></script>
    
</body>
</html>